"""建物名の読み仮名を生成するユーティリティ"""

import re
from typing import Optional

# カタカナ→ひらがな変換テーブル
KATAKANA_TO_HIRAGANA = str.maketrans(
    'アイウエオカキクケコサシスセソタチツテトナニヌネノハヒフヘホマミムメモヤユヨラリルレロワヲンガギグゲゴザジズゼゾダヂヅデドバビブベボパピプペポァィゥェォャュョッ',
    'あいうえおかきくけこさしすせそたちつてとなにぬねのはひふへほまみむめもやゆよらりるれろわをんがぎぐげござじずぜぞだぢづでどばびぶべぼぱぴぷぺぽぁぃぅぇぉゃゅょっ'
)

# 一般的な建物名の読み方辞書
READING_DICT = {
    # 地名・施設名
    '白金': 'しろかね',
    '赤坂': 'あかさか',
    '六本木': 'ろっぽんぎ',
    '青山': 'あおやま',
    '代官山': 'だいかんやま',
    '恵比寿': 'えびす',
    '目黒': 'めぐろ',
    '品川': 'しながわ',
    '渋谷': 'しぶや',
    '新宿': 'しんじゅく',
    '池袋': 'いけぶくろ',
    '上野': 'うえの',
    '浅草': 'あさくさ',
    '銀座': 'ぎんざ',
    '日本橋': 'にほんばし',
    '丸の内': 'まるのうち',
    '大手町': 'おおてまち',
    '神楽坂': 'かぐらざか',
    '飯田橋': 'いいだばし',
    '四谷': 'よつや',
    '麹町': 'こうじまち',
    '赤羽': 'あかばね',
    '北千住': 'きたせんじゅ',
    '南千住': 'みなみせんじゅ',
    '亀有': 'かめあり',
    '綾瀬': 'あやせ',
    '両国': 'りょうごく',
    '錦糸町': 'きんしちょう',
    '押上': 'おしあげ',
    '向島': 'むこうじま',
    '浅草橋': 'あさくさばし',
    '神田': 'かんだ',
    '秋葉原': 'あきはばら',
    '御茶ノ水': 'おちゃのみず',
    '水道橋': 'すいどうばし',
    '後楽園': 'こうらくえん',
    '本郷': 'ほんごう',
    '根津': 'ねづ',
    '千駄木': 'せんだぎ',
    '日暮里': 'にっぽり',
    '西日暮里': 'にしにっぽり',
    '田端': 'たばた',
    '駒込': 'こまごめ',
    '巣鴨': 'すがも',
    '大塚': 'おおつか',
    '護国寺': 'ごこくじ',
    '江戸川橋': 'えどがわばし',
    '早稲田': 'わせだ',
    '高田馬場': 'たかだのばば',
    '新大久保': 'しんおおくぼ',
    '代々木': 'よよぎ',
    '原宿': 'はらじゅく',
    '表参道': 'おもてさんどう',
    '外苑前': 'がいえんまえ',
    '乃木坂': 'のぎざか',
    '西麻布': 'にしあざぶ',
    '南麻布': 'みなみあざぶ',
    '東麻布': 'ひがしあざぶ',
    '麻布十番': 'あざぶじゅうばん',
    '白金台': 'しろかねだい',
    '白金高輪': 'しろかねたかなわ',
    '高輪': 'たかなわ',
    '高輪台': 'たかなわだい',
    '泉岳寺': 'せんがくじ',
    '田町': 'たまち',
    '三田': 'みた',
    '芝': 'しば',
    '芝公園': 'しばこうえん',
    '芝大門': 'しばだいもん',
    '浜松町': 'はままつちょう',
    '竹芝': 'たけしば',
    '汐留': 'しおどめ',
    '新橋': 'しんばし',
    '虎ノ門': 'とらのもん',
    '虎ノ門ヒルズ': 'とらのもんひるず',
    '溜池山王': 'ためいけさんのう',
    '永田町': 'ながたちょう',
    '霞が関': 'かすみがせき',
    '日比谷': 'ひびや',
    '有楽町': 'ゆうらくちょう',
    '東京': 'とうきょう',
    '八重洲': 'やえす',
    '京橋': 'きょうばし',
    '日本橋': 'にほんばし',
    '茅場町': 'かやばちょう',
    '兜町': 'かぶとちょう',
    '人形町': 'にんぎょうちょう',
    '水天宮前': 'すいてんぐうまえ',
    '小伝馬町': 'こでんまちょう',
    '馬喰町': 'ばくろちょう',
    '東日本橋': 'ひがしにほんばし',
    '岩本町': 'いわもとちょう',
    '小川町': 'おがわまち',
    '淡路町': 'あわじちょう',
    '大手町': 'おおてまち',
    '内幸町': 'うちさいわいちょう',
    '築地': 'つきじ',
    '勝どき': 'かちどき',
    '月島': 'つきしま',
    '佃': 'つくだ',
    '晴海': 'はるみ',
    '豊洲': 'とよす',
    '有明': 'ありあけ',
    '青海': 'あおみ',
    'お台場': 'おだいば',
    '木場': 'きば',
    '門前仲町': 'もんぜんなかちょう',
    '清澄白河': 'きよすみしらかわ',
    '森下': 'もりした',
    '住吉': 'すみよし',
    '菊川': 'きくかわ',
    '大島': 'おおじま',
    '西大島': 'にしおおじま',
    '東大島': 'ひがしおおじま',
    '船堀': 'ふなぼり',
    '一之江': 'いちのえ',
    '瑞江': 'みずえ',
    '篠崎': 'しのざき',
    '小岩': 'こいわ',
    '新小岩': 'しんこいわ',
    '平井': 'ひらい',
    '亀戸': 'かめいど',
    '大森': 'おおもり',
    '大森山王': 'おおもりさんのう',
    '平和島': 'へいわじま',
    '大鳥居': 'おおとりい',
    '蒲田': 'かまた',
    '糀谷': 'こうじや',
    '雑色': 'ぞうしき',
    '六郷土手': 'ろくごうどて',
    '多摩川': 'たまがわ',
    '下丸子': 'しもまるこ',
    '武蔵新田': 'むさししんでん',
    '矢口渡': 'やぐちのわたし',
    '池上': 'いけがみ',
    '千鳥町': 'ちどりちょう',
    '久が原': 'くがはら',
    '御嶽山': 'おんたけさん',
    '雪が谷大塚': 'ゆきがやおおつか',
    '石川台': 'いしかわだい',
    '洗足池': 'せんぞくいけ',
    '大岡山': 'おおおかやま',
    '北千束': 'きたせんぞく',
    '旗の台': 'はたのだい',
    '荏原中延': 'えばらなかのぶ',
    '戸越': 'とごし',
    '戸越公園': 'とごしこうえん',
    '中延': 'なかのぶ',
    '荏原町': 'えばらまち',
    '武蔵小山': 'むさしこやま',
    '西小山': 'にしこやま',
    '洗足': 'せんぞく',
    '大崎': 'おおさき',
    '大崎広小路': 'おおさきひろこうじ',
    '五反田': 'ごたんだ',
    '目黒': 'めぐろ',
    '不動前': 'ふどうまえ',
    '武蔵小杉': 'むさしこすぎ',
    '元住吉': 'もとすみよし',
    '日吉': 'ひよし',
    '綱島': 'つなしま',
    '大倉山': 'おおくらやま',
    '菊名': 'きくな',
    '妙蓮寺': 'みょうれんじ',
    '白楽': 'はくらく',
    '東白楽': 'ひがしはくらく',
    '反町': 'たんまち',
    '横浜': 'よこはま',
    '桜木町': 'さくらぎちょう',
    '関内': 'かんない',
    '石川町': 'いしかわちょう',
    '元町': 'もとまち',
    '中華街': 'ちゅうかがい',
    '山手': 'やまて',
    '根岸': 'ねぎし',
    '磯子': 'いそご',
    '新杉田': 'しんすぎた',
    '洋光台': 'ようこうだい',
    '港南台': 'こうなんだい',
    '本郷台': 'ほんごうだい',
    '大船': 'おおふな',
    '北鎌倉': 'きたかまくら',
    '鎌倉': 'かまくら',
    '由比ヶ浜': 'ゆいがはま',
    '長谷': 'はせ',
    '極楽寺': 'ごくらくじ',
    '稲村ヶ崎': 'いなむらがさき',
    '七里ヶ浜': 'しちりがはま',
    '鎌倉高校前': 'かまくらこうこうまえ',
    '腰越': 'こしごえ',
    '片瀬江ノ島': 'かたせえのしま',
    '藤沢': 'ふじさわ',
    '辻堂': 'つじどう',
    '茅ヶ崎': 'ちがさき',
    '平塚': 'ひらつか',
    '大磯': 'おおいそ',
    '二宮': 'にのみや',
    '国府津': 'こうづ',
    '小田原': 'おだわら',
    '箱根湯本': 'はこねゆもと',
    '強羅': 'ごうら',
    '仙石原': 'せんごくはら',
    '芦ノ湖': 'あしのこ',
    
    # 建物タイプ
    'ハイツ': 'はいつ',
    'コーポ': 'こーぽ',
    'マンション': 'まんしょん',
    'レジデンス': 'れじでんす',
    'パレス': 'ぱれす',
    'ハウス': 'はうす',
    'ヴィラ': 'ゔぃら',
    'メゾン': 'めぞん',
    'コート': 'こーと',
    'プラザ': 'ぷらざ',
    'タワー': 'たわー',
    'スカイ': 'すかい',
    'ガーデン': 'がーでん',
    'パーク': 'ぱーく',
    'テラス': 'てらす',
    'フォレスト': 'ふぉれすと',
    'グランド': 'ぐらんど',
    'エクセル': 'えくせる',
    'プレミア': 'ぷれみあ',
    'ロイヤル': 'ろいやる',
    'シティ': 'してぃ',
    'アーバン': 'あーばん',
    'ステージ': 'すてーじ',
    'フロント': 'ふろんと',
    'クレスト': 'くれすと',
    'アクシス': 'あくしす',
    'ヒルズ': 'ひるず',
    'リバー': 'りばー',
    'オーシャン': 'おーしゃん',
    'ベイ': 'べい',
    'サニー': 'さにー',
    'ブライト': 'ぶらいと',
    'ファースト': 'ふぁーすと',
    'セカンド': 'せかんど',
    'サード': 'さーど',
    'ルミナス': 'るみなす',
    'グレース': 'ぐれーす',
    'エレガンス': 'えれがんす',
    'プライム': 'ぷらいむ',
    'アルファ': 'あるふぁ',
    'ベータ': 'べーた',
    'オメガ': 'おめが',
    'ユニオン': 'ゆにおん',
    'セントラル': 'せんとらる',
    'サウス': 'さうす',
    'ノース': 'のーす',
    'イースト': 'いーすと',
    'ウエスト': 'うえすと',
    'アネックス': 'あねっくす',
    'エクセレント': 'えくせれんと',
    'ブリリアント': 'ぶりりあんと',
    'ダイヤモンド': 'だいやもんど',
    'ルビー': 'るびー',
    'サファイア': 'さふぁいあ',
    'エメラルド': 'えめらるど',
    'クリスタル': 'くりすたる',
    'パール': 'ぱーる',
    
    # 方角・位置
    '東': 'ひがし',
    '西': 'にし',
    '南': 'みなみ',
    '北': 'きた',
    '中央': 'ちゅうおう',
    '上': 'かみ',
    '下': 'しも',
    '前': 'まえ',
    '後': 'うしろ',
    '内': 'うち',
    '外': 'そと',
    
    # 数字
    '一': 'いち',
    '二': 'に',
    '三': 'さん',
    '四': 'よん',
    '五': 'ご',
    '六': 'ろく',
    '七': 'なな',
    '八': 'はち',
    '九': 'きゅう',
    '十': 'じゅう',
    
    # その他
    '第': 'だい',
    '新': 'しん',
    '旧': 'きゅう',
    '大': 'だい',
    '小': 'しょう',
    '高': 'たか',
    '低': 'てい',
    '美': 'び',
    '栄': 'さかえ',
    '幸': 'さいわい',
    '寿': 'ことぶき',
    '和': 'わ',
    '平': 'たいら',
    '成': 'なり',
    '昭': 'あき',
    '明': 'あかり',
    '光': 'ひかり',
    '輝': 'かがやき',
    '希': 'のぞみ',
    '望': 'のぞみ',
    '夢': 'ゆめ',
    '愛': 'あい',
    '心': 'こころ',
    '絆': 'きずな',
    '縁': 'えん',
    '結': 'ゆい',
    '華': 'はな',
    '花': 'はな',
    '桜': 'さくら',
    '梅': 'うめ',
    '松': 'まつ',
    '竹': 'たけ',
    '蘭': 'らん',
    '菊': 'きく',
    '藤': 'ふじ',
    '葵': 'あおい',
    '椿': 'つばき',
    '紅': 'くれない',
    '緑': 'みどり',
    '青': 'あお',
    '赤': 'あか',
    '白': 'しろ',
    '黒': 'くろ',
    '金': 'きん',
    '銀': 'ぎん',
    '銅': 'どう',
    '鉄': 'てつ',
    '鋼': 'はがね',
    '石': 'いし',
    '岩': 'いわ',
    '山': 'やま',
    '川': 'かわ',
    '海': 'うみ',
    '空': 'そら',
    '雲': 'くも',
    '風': 'かぜ',
    '雨': 'あめ',
    '雪': 'ゆき',
    '氷': 'こおり',
    '火': 'ひ',
    '水': 'みず',
    '土': 'つち',
    '木': 'き',
    '森': 'もり',
    '林': 'はやし',
    '野': 'の',
    '原': 'はら',
    '里': 'さと',
    '郷': 'さと',
    '村': 'むら',
    '町': 'まち',
    '市': 'し',
    '区': 'く',
    '都': 'と',
    '府': 'ふ',
    '県': 'けん',
    '国': 'くに',
    '世': 'よ',
    '界': 'かい',
}


def generate_reading(building_name: str) -> Optional[str]:
    """建物名から読み仮名を生成する
    
    Args:
        building_name: 建物名
        
    Returns:
        読み仮名（ひらがな）、生成できない場合はNone
    """
    if not building_name:
        return None
    
    # まずカタカナをひらがなに変換
    reading = building_name.translate(KATAKANA_TO_HIRAGANA)
    
    # アルファベットを小文字に変換
    reading = reading.lower()
    
    # 漢字部分を読み仮名に変換
    for kanji, kana in sorted(READING_DICT.items(), key=lambda x: len(x[0]), reverse=True):
        reading = reading.replace(kanji, kana)
    
    # 数字を読み仮名に変換
    reading = re.sub(r'１', 'いち', reading)
    reading = re.sub(r'２', 'に', reading)
    reading = re.sub(r'３', 'さん', reading)
    reading = re.sub(r'４', 'よん', reading)
    reading = re.sub(r'５', 'ご', reading)
    reading = re.sub(r'６', 'ろく', reading)
    reading = re.sub(r'７', 'なな', reading)
    reading = re.sub(r'８', 'はち', reading)
    reading = re.sub(r'９', 'きゅう', reading)
    reading = re.sub(r'０', 'ぜろ', reading)
    
    # 半角数字も変換
    reading = re.sub(r'1', 'いち', reading)
    reading = re.sub(r'2', 'に', reading)
    reading = re.sub(r'3', 'さん', reading)
    reading = re.sub(r'4', 'よん', reading)
    reading = re.sub(r'5', 'ご', reading)
    reading = re.sub(r'6', 'ろく', reading)
    reading = re.sub(r'7', 'なな', reading)
    reading = re.sub(r'8', 'はち', reading)
    reading = re.sub(r'9', 'きゅう', reading)
    reading = re.sub(r'0', 'ぜろ', reading)
    
    # 特殊文字を削除
    reading = re.sub(r'[・、。「」（）\(\)【】\[\]《》〈〉『』「」""''＜＞<>]', '', reading)
    reading = re.sub(r'[\s　]+', '', reading)  # スペースを削除
    
    # すべて漢字が変換されていない場合（まだ漢字が残っている場合）はNoneを返す
    if re.search(r'[\u4e00-\u9fff]', reading):
        return None
    
    # アルファベットが残っている場合もそのまま返す（例：azest → azest）
    
    return reading.strip() if reading.strip() else None